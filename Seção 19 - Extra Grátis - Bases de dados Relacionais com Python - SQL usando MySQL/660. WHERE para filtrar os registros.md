# Passo a passo — filtrar (WHERE) e usar UPDATE / DELETE com segurança

Vou simplificar tudo que você falou em passos claros, com exemplos práticos e avisos de segurança. Use isso como checklist sempre que for filtrar, atualizar ou apagar dados.

---

## 1 — Entenda o papel do `WHERE`

* `WHERE` **filtra** quais linhas a consulta vai afetar.
* **Sempre** use `WHERE` em `UPDATE` e `DELETE` (salvo se você realmente quer alterar/apagar a tabela inteira).

---

## 2 — Sintaxe básica do `SELECT` com `WHERE`

```sql
SELECT * FROM users
WHERE id = 110;
```

* Exemplo acima retorna só o usuário cujo `id` = 110.
* Para números: sem aspas (`110`).
* Para texto/datas: com aspas `'texto'` / `'2024-06-01'`.

---

## 3 — Operadores de comparação essenciais

* Igual: `=`
* Diferente: `<>` ou `!=`
* Maior / Menor: `>` , `<`
* Maior ou igual / Menor ou igual: `>=` , `<=`
  Exemplo:

```sql
SELECT * FROM users WHERE id > 100;
SELECT * FROM users WHERE name <> 'Maria';
```

---

## 4 — Filtrando por datas

Formato comum: `'YYYY-MM-DD'` ou `'YYYY-MM-DD HH:MM:SS'`

```sql
SELECT * FROM users
WHERE created_at > '2024-01-01';
```

Funciona com os mesmos operadores (`>`, `<`, `>=`, `<=`).

---

## 5 — Combinar condições (AND / OR)

* `AND` = todas as condições devem ser verdadeiras.
* `OR` = qualquer uma verdadeira.
  Use parênteses para clareza:

```sql
-- ambos verdadeiros
SELECT * FROM users
WHERE created_at < '2024-01-01' AND name = 'Luiz';

-- qualquer um verdadeiro
SELECT * FROM users
WHERE name = 'Luiz' OR name = 'Maria';

-- combinação com parênteses
SELECT * FROM users
WHERE (created_at < '2024-01-01' AND active = true)
   OR role = 'admin';
```

---

## 6 — Outros filtros úteis (rápido)

* `IN` — lista de valores:

```sql
SELECT * FROM users WHERE id IN (1,2,3);
```

* `BETWEEN` — intervalo:

```sql
SELECT * FROM orders WHERE total BETWEEN 50 AND 100;
```

* `IS NULL` / `IS NOT NULL` — checar nulos:

```sql
SELECT * FROM profiles WHERE bio IS NULL;
```

* `LIKE` — busca por padrão (strings):

```sql
SELECT * FROM users WHERE name LIKE 'Lu%'; -- começa com 'Lu'
```

---

## 7 — Sempre teste com `SELECT` antes de `UPDATE`/`DELETE`

1. Monte o filtro com `SELECT` para ver exatamente quais linhas serão afetadas:

```sql
SELECT * FROM users WHERE last_login < '2022-01-01';
```

2. Só então aplique a ação:

```sql
UPDATE users
SET active = false
WHERE last_login < '2022-01-01';
```

---

## 8 — Exemplo de `UPDATE` seguro

```sql
-- verifique primeiro
SELECT id, name, email FROM users WHERE id = 110;

-- atualize só o registro desejado
UPDATE users
SET name = 'Luiz Otávio'
WHERE id = 110;
```

---

## 9 — Exemplo de `DELETE` seguro

```sql
-- confirmar o que será apagado
SELECT * FROM sessions WHERE user_id = 110;

-- apagar somente esses
DELETE FROM sessions WHERE user_id = 110;
```

**Nunca** rode `DELETE FROM sessions;` sem `WHERE` — apaga tudo.

---

## 10 — Dicas de segurança extras

* Use **transações** quando possível:

```sql
BEGIN;
UPDATE ... WHERE ...;
-- se algo errado:
ROLLBACK;
-- se ok:
COMMIT;
```

* Em ambientes como MySQL você pode usar `LIMIT` em `UPDATE/DELETE` (mas não é padrão SQL em todos os bancos).
* Prefira filtrar por **chave primária (id)** sempre que possível — é mais seguro e previsível.
* Faça backup ou teste em ambiente de desenvolvimento antes de rodar em produção.

---

## 11 — Resumo rápido (checklist)

* ✅ Monte o filtro com `SELECT` e confira os resultados.
* ✅ Use `WHERE` em `UPDATE` e `DELETE`.
* ✅ Use `AND/OR` e parênteses para combinar filtros.
* ✅ Teste com transação (`BEGIN`/`ROLLBACK`) quando puder.
* ✅ Filtre por `id` sempre que possível.

---

Quer que eu gere um pequeno conjunto de exemplos práticos (SELECT → UPDATE → DELETE) usando a tabela `users` para você copiar e treinar?
