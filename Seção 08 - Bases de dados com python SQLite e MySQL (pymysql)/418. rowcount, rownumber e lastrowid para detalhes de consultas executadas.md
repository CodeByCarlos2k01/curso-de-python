Aqui está a explicação simplificada em um **passo a passo prático sobre cursors, fetch e last row ID**:

---

## 1️⃣ Cursor básico

* Estamos usando **DictCursor** (retorna dicionários) sem buffer.
* `cursor.execute("SELECT * FROM tabela")` retorna todos os dados da tabela.
* Para salvar resultados em uma variável:

  ```python
  resultados = cursor.fetchall()
  ```
* Você pode usar `len(resultados)` para contar quantas linhas foram retornadas.

---

## 2️⃣ Métodos importantes do cursor

* **rowcount** → número de linhas afetadas pela última operação SQL.
* **lastrowid** → ID do último registro inserido.

  * Funciona apenas após um **INSERT**.
  * Em `executemany`, retorna o **primeiro ID inserido**, não o último.

---

## 3️⃣ Alternativa para obter o último ID

* Se `lastrowid` não funcionar ou for contraintuitivo:

  ```sql
  SELECT id FROM tabela ORDER BY id DESC LIMIT 1;
  ```

  * Retorna o **maior ID** da tabela.

---

## 4️⃣ Scroll do cursor

* O cursor mantém a posição interna: após um `for`, ele não reinicia sozinho.
* Você pode mover manualmente:

  ```python
  cursor.scroll(n, mode='relative')   # relativo à posição atual
  cursor.scroll(n, mode='absolute')   # posição exata no resultado
  ```
* Importante: em cursors **sem buffer**, scroll para trás pode não funcionar.

---

## 5️⃣ Usos práticos

* `rowcount` → ver quantas linhas foram afetadas (SELECT, UPDATE, DELETE).
* `lastrowid` → obter ID do último registro inserido (INSERT).
* `cursor.scroll()` → navegar entre linhas quando necessário, principalmente em **grandes volumes de dados**.
* `fetchall()` → pega todos os registros de uma vez.

---

Se você quiser, posso criar uma **tabela visual com todos os métodos do cursor, exemplos e quando usar**, que facilita muito a memorização.

Quer que eu faça isso?
