# Passo a passo — usar PyMySQL com Python (super direto)

1. **Crie/ative um virtualenv**

```bash
python -m venv .venv
# Linux / macOS
source .venv/bin/activate
# Windows (cmd)
.venv\Scripts\activate
```

2. **Instale dependências**

```bash
pip install PyMySQL python-dotenv
# (Se usar type-checker e aparecer aviso de tipos, procure stubs para o pacote, ex.: "types-<nome>" no PyPI)
```

3. **Crie um `.env`** (na pasta do projeto)

```env
MYSQL_HOST=localhost
MYSQL_PORT=3306
MYSQL_DATABASE=base_de_dados
MYSQL_USER=usuario
MYSQL_PASSWORD=senha
TZ=America/Recife
```

4. **Carregue as variáveis no Python**

```python
from dotenv import load_dotenv
import os

load_dotenv()
HOST = os.getenv("MYSQL_HOST", "localhost")
PORT = int(os.getenv("MYSQL_PORT", 3306))
DB   = os.getenv("MYSQL_DATABASE")
USER = os.getenv("MYSQL_USER")
PWD  = os.getenv("MYSQL_PASSWORD")
```

5. **Conecte e execute queries — use context managers (`with`)**

```python
import pymysql
from pymysql.cursors import DictCursor

conn = pymysql.connect(
    host=HOST, port=PORT, user=USER, password=PWD,
    database=DB, charset="utf8mb4", cursorclass=DictCursor
)

# usando context managers — NÃO precisa fechar manualmente
with conn:
    with conn.cursor() as cur:
        cur.execute("SELECT NOW() AS agora;")
        print(cur.fetchone())
```

6. **Se não usar `with`, feche explicitamente**

```python
cur = conn.cursor()
cur.execute("SELECT 1")
cur.close()
conn.close()
```

7. **Por que definir `database` na conexão?**

   * Evita ter que usar `base.tabela` nas consultas; tudo já roda na DB correta.

8. **Boas práticas rápidas**

   * Não use `root` em produção; prefira um usuário limitado.
   * Mantenha `.env` fora do Git (`.gitignore`).
   * Salve dependências: `pip freeze > requirements.txt`.
   * Use `cursorclass=DictCursor` se preferir resultados em dicionário.

Pronto — com isso você instala PyMySQL, carrega credenciais do `.env`, abre a conexão corretamente e usa `with` para fechar conexão/cursor automaticamente. Quer que eu gere um snippet pronto para colar no seu projeto?
