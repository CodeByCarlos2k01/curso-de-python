# Passo a passo (simples) — `created_by` / `updated_by` no Admin do Django

1. **Adicionar campos no `models.py`**

   ```py
   from django.contrib.auth import get_user_model
   from django.db import models

   User = get_user_model()

   class Post(models.Model):
       # ... seus outros campos ...
       created_by = models.ForeignKey(
           User, on_delete=models.SET_NULL,
           null=True, blank=True, related_name="posts_created"
       )
       updated_by = models.ForeignKey(
           User, on_delete=models.SET_NULL,
           null=True, blank=True, related_name="posts_updated"
       )

       def __str__(self):
           return self.title
   ```

   * `SET_NULL` evita apagar posts se o usuário for removido.
   * `related_name` evita conflito quando há mais de uma FK para `User`.

2. **Gerar e aplicar migrações**

   ```bash
   python manage.py makemigrations
   python manage.py migrate
   ```

   (Se estiver usando Docker: rode via `docker compose run ... python manage.py ...`.)

3. **Registrar os campos no Admin (sobrescrever `save_model`)**
   Em `admin.py` do app, crie/edite o `ModelAdmin` do `Post`:

   ```py
   from django.contrib import admin
   from .models import Post

   @admin.register(Post)
   class PostAdmin(admin.ModelAdmin):
       list_display = ("id", "title", "is_publish", "created_by", "updated_by", "created_at")
       readonly_fields = ("created_by", "updated_by", "created_at", "updated_at")

       def save_model(self, request, obj, form, change):
           # change == True  -> estamos editando um objeto já existente
           # change == False -> estamos criando um novo objeto
           if change:
               obj.updated_by = request.user
           else:
               obj.created_by = request.user
           super().save_model(request, obj, form, change)
   ```

   * Usar `save_model` aplica somente quando o objeto é salvo pela **admin interface** (o que você queria).
   * Não sobrescreva `model.save()` se não quiser que a lógica execute em todos os lugares do projeto.

4. **Testar no Admin**

   * Criar um post novo → `created_by` deve ser preenchido automaticamente.
   * Editar um post existente → `updated_by` deve passar a ser o usuário que salvou.

5. **Observações / boas práticas**

   * `readonly_fields` evita que admins editem manualmente esses campos.
   * Se tiver APIs ou formulários externos, eles **não** vão preencher esses campos automaticamente — nesses casos você deve setar `created_by/updated_by` no view/serializer/endpoint correspondente.
   * Se precisar gravar quem criou/atualizou em outros fluxos, use a mesma ideia no view ou sinal (`signal`) apropriado.

Pronto — implementando esses 4 passos você terá `created_by` e `updated_by` funcionando apenas na área administrativa do Django. Quer que eu gere os trechos completos de `models.py` + `admin.py` prontos para copiar?
