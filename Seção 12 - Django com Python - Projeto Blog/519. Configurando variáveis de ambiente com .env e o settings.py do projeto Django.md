# Passo a passo — variáveis de ambiente (`.env`)

1. **Criar `.env.example` (versão pública de exemplo)**

   * Na raiz do projeto crie um arquivo chamado `.env.example` com as chaves (sem valores sensíveis):

   ```text
   SECRET_KEY=
   DEBUG=1
   ALLOWED_HOSTS=127.0.0.1,localhost
   DB_ENGINE=django.db.backends.postgresql
   DB_NAME=blog_db
   DB_USER=blog_user
   DB_PASSWORD=blog_password
   DB_HOST=localhost
   DB_PORT=5432
   STATIC_URL=/static/
   MEDIA_URL=/media/
   ```

   * Commit apenas este arquivo (ele serve como guia para quem for clonar o repositório).

2. **Adicionar `.env` ao `.gitignore`**

   * Não versione o `.env` real (contém segredos). No `.gitignore` inclua:

   ```
   .env
   .venv/
   ```

3. **Criar o `.env` local**

   * Copie o exemplo e edite os valores reais no seu computador:

   ```bash
   cp .env.example .env      # Linux/macOS
   copy .env.example .env    # Windows (cmd)
   ```

   * Preencha `SECRET_KEY`, senha do DB etc. **Remova aspas** dos valores (use sem `"`).

4. **Gerar `SECRET_KEY` (recomendado)**

   * Exemplo de comando para gerar uma secret segura:

   ```bash
   python -c "from django.core.management.utils import get_random_secret_key; print(get_random_secret_key())"
   ```

   * Cole o resultado em `SECRET_KEY` no `.env`.

5. **Formato de `ALLOWED_HOSTS`**

   * Defina valores separados por vírgula em `.env`: `127.0.0.1,localhost`
   * No `settings.py` você vai transformar essa string numa lista (veja passo 7).

6. **Não use `.env` no GitHub**

   * Confirme que `.env` está ignorado e **commit** apenas `.env.example`.

7. **Ler variáveis no `settings.py` (exemplo mínimo)**

   * Adicione/edite no topo:

   ```python
   import os
   from pathlib import Path

   BASE_DIR = Path(__file__).resolve().parent.parent
   SECRET_KEY = os.getenv('SECRET_KEY', 'insecure-default')
   DEBUG = bool(int(os.getenv('DEBUG', '0')))
   ALLOWED_HOSTS = [h.strip() for h in os.getenv('ALLOWED_HOSTS', '').split(',') if h.strip()]
   ```

   * Configurar `DATABASES` lendo do `.env`:

   ```python
   DATABASES = {
       'default': {
           'ENGINE': os.getenv('DB_ENGINE', 'django.db.backends.sqlite3'),
           'NAME': os.getenv('DB_NAME', str(BASE_DIR / 'db.sqlite3')),
           'USER': os.getenv('DB_USER', ''),
           'PASSWORD': os.getenv('DB_PASSWORD', ''),
           'HOST': os.getenv('DB_HOST', ''),
           'PORT': os.getenv('DB_PORT', ''),
       }
   }
   ```

8. **Configurar `STATIC_ROOT` e `MEDIA_ROOT` (ex.: fora da pasta do Django)**

   ```python
   DATA_DIR = BASE_DIR.parent / 'data' / 'web'
   STATIC_ROOT = str(DATA_DIR / 'static')
   MEDIA_ROOT = str(DATA_DIR / 'media')
   STATIC_URL = os.getenv('STATIC_URL', '/static/')
   MEDIA_URL = os.getenv('MEDIA_URL', '/media/')
   ```

9. **Servir static/media só em DEBUG (urls.py)**

   ```python
   from django.conf import settings
   from django.conf.urls.static import static

   if settings.DEBUG:
       urlpatterns += static(settings.MEDIA_URL, document_root=settings.MEDIA_ROOT)
       urlpatterns += static(settings.STATIC_URL, document_root=settings.STATIC_ROOT)
   ```

10. **Uso com Docker**

    * O Docker deve carregar as variáveis do `.env` (ex.: `env_file: - .env` em `docker-compose.yml`) para que o container tenha as mesmas configurações.
    * Enquanto estiver usando Docker, não deixe o `.env` no repositório.

11. **Commit (o que commitar)**

    ```bash
    git add .env.example .gitignore path/to/settings.py path/to/urls.py
    git commit -m "Add env example and read config from env"
    git push
    ```

    * **Nunca** commite o `.env` real.

12. **Resumo rápido**

    * `.env.example` → público (guia).
    * `.env` → local, com valores reais, **ignorado** pelo git.
    * `settings.py` → usa `os.getenv()`; converte `DEBUG` para `bool`, split/strip em `ALLOWED_HOSTS`.
    * Docker deve ser configurado para carregar o `.env` quando construir/rodar a imagem.

Quer que eu gere um `.env.example` pronto com as variáveis acima e um trecho de `settings.py` pronto para você copiar?
