# Passo a passo — Definir títulos dinâmicos e tratamento de 404 no blog

1. **Adicionar título da página no template**

   * No template base ou parcial (`partials/header.html`), adicione uma variável `page_title`:

     ```django
     <title>{{ page_title }} - Meu Blog</title>
     ```

2. **Injetar título no contexto da view**

   * No `views.py`, para cada view, defina o `page_title`:

     ```python
     context = {'page_title': 'Home'}
     return render(request, 'blog/index.html', context)
     ```

3. **Título para posts de autores**

   * Obtenha o autor do post:

     ```python
     from django.contrib.auth.models import User
     user = User.objects.filter(pk=author.pk).first()
     ```
   * Defina o título com o nome do autor:

     ```python
     if user.first_name:
         user_full_name = f"{user.first_name} {user.last_name}"
     else:
         user_full_name = user.username
     page_title = f"Posts de {user_full_name} - Meu Blog"
     ```

4. **Título para categorias**

   * Pegue o primeiro post da categoria:

     ```python
     if posts.exists():
         page_title = f"Categoria {posts.first().category.name} - Meu Blog"
     else:
         raise Http404
     ```

5. **Título para tags**

   * Para uma tag many-to-many:

     ```python
     if posts.exists():
         page_title = f"Tag {posts.first().tags.first().name} - Meu Blog"
     else:
         raise Http404
     ```

6. **Título para busca (search)**

   * Limite o tamanho do texto da busca para evitar strings muito longas:

     ```python
     search_query = request.GET.get('search', '').strip()[:30]
     page_title = f"Busca: {search_query}"
     ```

7. **Tratamento de 404**

   * Sempre verifique se o objeto existe antes de renderizar:

     ```python
     from django.http import Http404

     if not page:
         raise Http404("Página não encontrada")
     if not posts.exists():
         raise Http404("Posts não encontrados")
     ```

8. **Evitar conflitos de nomes em variáveis**

   * Use nomes diferentes para função e objeto:

     ```python
     def page(request, slug):
         page_object = get_object_or_404(Page, slug=slug, is_published=True)
         page_title = page_object.title
         return render(request, 'blog/page.html', {'page': page_object, 'page_title': page_title})
     ```

9. **Testar todos os casos**

   * Página inicial: `Home - Meu Blog`
   * Post de autor: `Posts de Maria Helena - Meu Blog`
   * Categoria existente: `Categoria JavaScript - Meu Blog`
   * Tag existente: `Tag Python - Meu Blog`
   * Busca: `Busca: termo buscado`
   * Objetos inexistentes: deve levantar `404 Page Not Found`

Isso garante títulos dinâmicos claros, consistentes e tratamento correto de páginas inexistentes.
