Perfeito — aqui vai a explicação **simplificada e passo a passo**, com exemplos práticos em SQL. Vou cobrir operadores básicos, como filtrar um *range* com `BETWEEN` e com `>= / <`, como lidar com **datas** (e horas), e boas práticas.

---

# Passo a passo — filtrar intervals e ranges em SQL

## 1) Operadores básicos que você já conhece

Use no `WHERE`:

* `=` igual
* `<>` ou `!=` diferente
* `<` menor que
* `<=` menor ou igual
* `>` maior que
* `>=` maior ou igual

Exemplo:

```sql
SELECT * FROM users WHERE id = 110;
SELECT * FROM users WHERE id > 100;
```

---

## 2) Filtrando com duas condições (AND)

Para criar um intervalo manual:

```sql
SELECT * FROM users
WHERE created_at >= '2020-01-01'
  AND created_at <= '2020-01-31 23:59:59';
```

> Aqui você combina duas condições — a versão `>=` e `<=` é comum.

---

## 3) Sintaxe `BETWEEN` (mais curto)

`BETWEEN` seleciona valores **entre** dois limites **inclusive** (inclui os extremos):

```sql
-- datas (inclusive)
SELECT * FROM users
WHERE created_at BETWEEN '2020-01-01' AND '2020-01-31';

-- números
SELECT * FROM products
WHERE price BETWEEN 100 AND 200;
```

**Importante:** `BETWEEN a AND b` é equivalente a `>= a AND <= b` (ou seja, inclusivo).

---

## 4) Problema comum com timestamps (horas)

Se sua coluna é `TIMESTAMP` (tem horário), `BETWEEN '2020-01-01' AND '2020-01-31'` vai incluir `2020-01-31 00:00:00` mas **não** incluir `2020-01-31 12:00:00` — por isso:

### 4.a — Solução segura (padrão recomendado)

Use intervalo com `>= start AND < day_after_end` (end-exclusive):

```sql
-- pega todos de 2020-01-01 até 2020-01-31 (inclusive, independente da hora)
SELECT * FROM users
WHERE created_at >= '2020-01-01'
  AND created_at <  '2020-02-01';
```

Essa técnica evita problemas com horas e fusos.

### 4.b — Alternativa com horário final explícito

Se preferir manter `<=`, especifique fim do dia:

```sql
WHERE created_at >= '2020-01-01'
  AND created_at <= '2020-01-31 23:59:59'
```

Mas cuidado: segundos/fracionados e timezones podem complicar — por isso a técnica `>= ... AND < next_day` é mais robusta.

---

## 5) Ignorar a hora (apenas data) — cuidado com índices

Você pode comparar só a parte `DATE`:

```sql
SELECT * FROM users
WHERE DATE(created_at) BETWEEN '2020-01-01' AND '2020-01-31';
```

**Atenção:** `DATE(created_at)` aplica função na coluna e geralmente **impede uso de índice** (mais lento). Prefira a estratégia `>= start AND < next_day` quando performance importa.

---

## 6) Ranges para números (exemplo)

`BETWEEN` funciona com números:

```sql
SELECT * FROM orders
WHERE total_amount BETWEEN 50 AND 100;
```

Novamente: inclui 50 e 100.

Se quiser exclusivo no limite superior:

```sql
WHERE total_amount >= 50 AND total_amount < 100;
```

---

## 7) Combinar condições (AND / OR)

Use parênteses para agrupar:

```sql
SELECT * FROM users
WHERE (created_at >= '2020-01-01' AND created_at < '2020-02-01')
  AND (status = 'active' OR role = 'admin');
```

---

## 8) Ordenar e paginar resultados

Depois do filtro, você geralmente ordena:

```sql
SELECT * FROM users
WHERE created_at BETWEEN '2020-01-01' AND '2020-01-31'
ORDER BY created_at DESC
LIMIT 10 OFFSET 0;  -- primeiros 10
```

---

## 9) Sempre verifique antes de alterar/apagar

Antes de `UPDATE` ou `DELETE`, rode um `SELECT` com o mesmo `WHERE`:

```sql
-- confirmar
SELECT COUNT(*) FROM users WHERE created_at BETWEEN '2020-01-01' AND '2020-01-31';

-- depois, se OK
DELETE FROM users WHERE created_at BETWEEN '2020-01-01' AND '2020-01-31';
```

---

## 10) Boas práticas / dicas rápidas

* `BETWEEN` é **inclusivo** em ambos os lados.
* Para **timestamps**, prefira `created_at >= start AND created_at < next_day_after_end`.
* Evite funções na coluna do `WHERE` (ex.: `DATE(created_at)`) se precisar de performance (índices).
* Sempre use `SELECT` antes de `UPDATE`/`DELETE`.
* Para queries com parâmetros, use **prepared statements** (evita SQL injection).
* Garanta que a coluna usada no range tenha **índice** se for consulta comum (melhora muito performance).

---

## 11) Resumo rápido (cheat sheet)

```sql
-- BETWEEN (inclusive)
SELECT * FROM table WHERE col BETWEEN a AND b;

-- Range seguro para timestamps (recomendado)
SELECT * FROM table WHERE ts >= '2020-01-01' AND ts < '2020-02-01';

-- Ignorar hora (cuidado com índice)
SELECT * FROM table WHERE DATE(ts) BETWEEN '2020-01-01' AND '2020-01-31';

-- Números (inclusive)
SELECT * FROM products WHERE price BETWEEN 100 AND 200;

-- Combinação
SELECT * FROM users WHERE created_at BETWEEN '2020-01-01' AND '2020-01-31' AND status = 'active';
```

---

Quer que eu gere exemplos prontos com os **dados da sua tabela** (por ex. `users.created_at`) — SELECTs para testar, depois UPDATE/DELETE seguros e uma versão com paginação? Posso criar um bloco SQL pronto pra copiar e colar no seu DBeaver.
