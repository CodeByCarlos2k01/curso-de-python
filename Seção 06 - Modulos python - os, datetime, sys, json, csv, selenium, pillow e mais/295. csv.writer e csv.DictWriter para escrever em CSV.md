# Passo a passo — Escrever CSV em Python (simples e direto)

1. **Escolha o formato dos seus dados**

   * **Lista de listas** → cada linha é uma `list` (usar `csv.writer`).
   * **Lista de dicionários** → cada linha é um `dict` (usar `csv.DictWriter`).

2. **Defina o cabeçalho (colunas)**

   * Se tiver `lista_de_dicts` e quiser pegar as colunas automaticamente:

     ```py
     if lista_de_dicts:
         fieldnames = list(lista_de_dicts[0].keys())
     else:
         fieldnames = ["nome","idade"]  # fallback
     ```
   * Ou defina manualmente (mantém ordem garantida): `fieldnames = ["nome","idade","endereco"]`

3. **Abra o arquivo corretamente**

   * Sempre `newline=''` para evitar linhas em branco no Windows; e especifique `encoding`.

   ```py
   from pathlib import Path
   path = Path("aula180.csv")
   with path.open("w", encoding="utf-8", newline="") as f:
       ...
   ```

4. **Escrevendo com `csv.writer` (listas)**

   ```py
   import csv

   rows = [
       ["nome","idade","endereco"],    # opcional: cabeçalho manual
       ["Luiz", "30", "Rua A"],
       ["Maria","25","Rua B"],
   ]

   with path.open("w", encoding="utf-8", newline="") as f:
       writer = csv.writer(f, delimiter=",")
       writer.writerows(rows)   # escreve todas as linhas de uma vez
   ```

   * Se usar cabeçalho separado, escreva `writer.writerow(header)` antes.

5. **Escrevendo com `csv.DictWriter` (dicionários)**

   ```py
   import csv

   clients = [
       {"nome":"Luiz","idade":"30","endereco":"Rua A"},
       {"nome":"Maria","idade":"25","endereco":"Rua B"},
   ]
   fieldnames = ["nome","idade","endereco"]  # ordem importa

   with path.open("w", encoding="utf-8", newline="") as f:
       writer = csv.DictWriter(f, fieldnames=fieldnames, delimiter=",")
       writer.writeheader()          # escreve o cabeçalho (opcional)
       writer.writerows(clients)     # aceita lista de dicts
   ```

6. **Dicas e cuidados**

   * Use `delimiter=";"` se seu CSV usa ponto-e-vírgula.
   * `DictWriter` associa valores às colunas por chave; a ordem vêm de `fieldnames`.
   * Se algum valor tiver vírgula/quebras, o módulo cuida do *quoting* automaticamente.
   * Salve/feche o arquivo no editor antes de sobrescrever para evitar conflitos.
   * Para muitos registros, `writer.writerows()` é eficiente; para transformações por item, use um `for` e `writer.writerow(...)`.

Pronto — com isso você consegue escrever CSVs com listas ou com dicionários de forma segura e controlando cabeçalhos e ordem de colunas. Quer que eu gere um exemplo completo com os seus dados reais?
